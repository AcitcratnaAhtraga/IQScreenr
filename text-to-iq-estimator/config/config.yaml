# Text-to-IQ Estimator Configuration

# Processing settings
processing:
  min_length_tokens: 30  # Reduced for testing with short samples
  min_length_vocab: 15
  language: "en"

  # Quality control flags
  strip_urls: true
  strip_code: true
  strip_quotes: true
  normalize_unicode: true

# Feature extraction settings
features:
  cwr:
    enabled: false  # Disabled: academic lexicon contained common words, skewing results
    lexicon_file: "academic_lexicon.txt"
    background_corpus_mean: 0.15  # Calibrate from your corpus
    background_corpus_std: 0.05
    use_lemmatization: true
    use_stemming: false

  stylometry:
    enabled: true
    # Lexical features
    compute_ttr: true
    compute_msttr: true
    compute_mtld: true
    compute_yules_k: true
    # AoA and concreteness require external datasets
    use_aoa: false
    use_concreteness: false

    # Surface features
    compute_length_stats: true
    compute_punctuation_entropy: true

    # POS and syntax
    compute_pos_ratios: true
    compute_dependency_depth: true
    compute_clause_density: true

    # Readability
    compute_flesch_kincaid: true
    compute_smog: true
    compute_ari: true
    compute_lix: true

    # Cohesion
    compute_lexical_overlap: true
    compute_referential_coherence: true
    compute_connectives: true

  embeddings:
    enabled: true
    model_name: "sentence-transformers/all-mpnet-base-v2"
    compute_paragraph_embedding: true
    compute_sentence_embeddings: true
    embedding_dim: 768
    device: "cpu"  # "cuda" if GPU available

  vocab_scorer:
    enabled: false  # Requires word embeddings model - disabled for now
    embedding_model: "word2vec"  # "word2vec", "fasttext", or "glove"
    word2vec_model_file: "data/models/word2vec.bin"
    cosine_threshold_1pt: 0.3
    cosine_threshold_2pt: 0.5

  aoa:
    enabled: true  # Set to true and provide absolute path or proper relative path
    aoa_file: "../IQresearch/Master file with all values for test based AoA measures.xlsx"  # Provide path to AoA Excel file here
    use_lemmatization: false
    use_stemming: false

# Model settings
models:
  ensemble:
    enabled: true
    base_learners:
      - elasticnet:
          alpha: 0.1
          l1_ratio: 0.5
          max_iter: 1000
      - gradient_boosting:
          n_estimators: 100
          learning_rate: 0.1
          max_depth: 5
          subsample: 0.8
      - random_forest:
          n_estimators: 200
          max_depth: 15
          min_samples_split: 5
          min_samples_leaf: 2
      - mlp:
          hidden_layer_sizes: [128, 64, 32]
          learning_rate_init: 0.001
          max_iter: 300
          early_stopping: true

    cv_folds: 5
    metric: "rmse"
    n_jobs: -1

  calibration:
    method: "isotonic"  # "isotonic" or "platt"
    cv_folds: 5
    estimate_calibration: true

# WASI-II Vocabulary conversion tables (approximate - get official from manual)
wasi_vocabulary:
  raw_to_vci: "data/calibration/raw_to_vci_lookup.csv"
  vci_to_fsiq2: "data/calibration/vci_to_fsiq2_lookup.csv"

# Bias and fairness controls
fairness:
  stratify_by_age: true
  stratify_by_education: true
  stratify_by_l1_l2: true

  age_bands:
    - [18, 25]
    - [26, 35]
    - [36, 50]
    - [51, 65]
    - [66, 100]

  education_levels:
    - "high_school"
    - "some_college"
    - "bachelor"
    - "graduate"

  report_dif: true
  re_calibrate_if_drift: true
  drift_threshold: 5.0  # IQ points

# Evaluation settings
evaluation:
  test_train_split: 0.2
  cv_folds: 5
  metrics:
    - "r2"
    - "mae"
    - "rmse"
    - "pearson_r"
    - "spearman_rho"

  report_confidence_intervals: true
  prediction_interval_level: 0.95

  ablation_studies:
    enabled: true
    test_combinations:
      - ["cwr", "stylometry", "embeddings"]
      - ["cwr"]
      - ["stylometry"]
      - ["embeddings"]

# Logging
logging:
  level: "INFO"
  log_file: "logs/text_to_iq_estimator.log"
  log_features: true
  log_predictions: true

# Output settings
output:
  include_feature_attributions: true
  include_shap_values: true
  include_cwr_baseline: true
  include_confidence_intervals: true

